<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Pide tus Huaraches La 18 a domicilio. El mejor sabor hasta tu casa.">
    <title>Huaraches La 18 | Men√∫ Digital</title>
    
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;700;900&display=swap');
        body { font-family: 'Poppins', sans-serif; -webkit-tap-highlight-color: transparent; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Animaciones */
        @keyframes fade-in-down { 0% { opacity: 0; transform: translateY(-10px); } 100% { opacity: 1; transform: translateY(0); } }
        @keyframes slide-up { 0% { opacity: 0; transform: translateY(15px); } 100% { opacity: 1; transform: translateY(0); } }
        .animate-fade-in-down { animation: fade-in-down 0.3s ease-out forwards; will-change: opacity, transform; }
        .animate-slide-up { animation: slide-up 0.3s ease-out forwards; will-change: opacity, transform; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #f97316; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        /* Efectos Visuales */
        @keyframes electric-glow {
            0% { box-shadow: 0 0 5px #fff, 0 0 10px #facc15, 0 0 20px #f97316; border-color: #ffffff; }
            50% { box-shadow: 0 0 20px #fff, 0 0 30px #facc15, 0 0 50px #ef4444; border-color: #fef08a; }
            100% { box-shadow: 0 0 5px #fff, 0 0 10px #facc15, 0 0 20px #f97316; border-color: #ffffff; }
        }
        .logo-electric { border-width: 6px; border-style: solid; animation: electric-glow 1.5s infinite alternate ease-in-out; }

        @keyframes shine-metal { 0% { background-position: 0% center; } 100% { background-position: 200% center; } }
        .text-metal-shine {
            background: linear-gradient(to right, #ca8a04 0%, #facc15 30%, #ffffff 50%, #facc15 70%, #ca8a04 100%);
            background-size: 200% auto; color: transparent; -webkit-background-clip: text; background-clip: text;
            animation: shine-metal 3s linear infinite; text-shadow: 0px 2px 4px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-800 min-h-screen text-lg selection:bg-orange-200">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback, memo } = React;

        // --- üîë CONEXI√ìN A SUPABASE ---
        // COLOCA TUS CLAVES REALES AQU√ç
        const SUPABASE_URL = 'https://uzpinrjzbucoihxuvdvm.supabase.co'; 
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV6cGlucmp6YnVjb2loeHV2ZHZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxNzEyNDgsImV4cCI6MjA3OTc0NzI0OH0.1bIIem8dU3VN-A8AH81smAt584zUD-Yf977MSUIEP2w';
        
        const supabase = (SUPABASE_URL !== 'PON_TU_URL_AQUI' && window.supabase && SUPABASE_URL.startsWith('http')) 
            ? window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY) 
            : null;

        const CONFIG = {
            storeName: "HUARACHES LA 18",
            phone: "5215625264945",
            shippingCost: 10.00,
            cardFeePercent: 0.035,
            
            // üìç COORDENADAS
            storeLocation: { lat: 19.308249, lng: -99.081290 }, 
            maxDeliveryRadius: 2.0, 
            
            assets: { logo: "/LOGO1.jpg", background: "/catrina1.jpg" }
        };

        // --- RESPALDO DE DATOS (CON DESCRIPCIONES CORREGIDAS) ---
        const STATIC_CATEGORIES = [
            { id: 1, nombre: "Huaraches", orden: 1, nota_preparacion: "Cebolla y Queso Rallado." },
            { id: 2, nombre: "Sopes", orden: 2, nota_preparacion: "Cebolla, Queso Rallado y Lechuga." },
            { id: 3, nombre: "Tacos", orden: 3, nota_preparacion: "Cebolla, Cilantro y Nopales." },
            { id: 4, nombre: "Gorditas", orden: 4, nota_preparacion: "Cebolla y Queso Rallado." },
            { id: 5, nombre: "Quesadillas", orden: 5, nota_preparacion: "Lechuga y Queso." },
            { id: 6, nombre: "Pambazos", orden: 6, nota_preparacion: "Crema, Queso Rallado y Lechuga." },
            { id: 7, nombre: "Tortas", orden: 7, nota_preparacion: "Cebolla y Cilantro." },
            { id: 8, nombre: "Tostadas", orden: 8, nota_preparacion: "Crema, Queso Rallado y Lechuga." },
            { id: 9, nombre: "Burritos y Costras", orden: 9, nota_preparacion: "Burritos: Nopales y Pepinos | Costras: Cebolla, Cilantro y Nopales." },
            { id: 10, nombre: "Bebidas", orden: 10, nota_preparacion: "Refrescantes y fr√≠as." }
        ];

        const STATIC_PRODUCTS = [
            {id:1, categoria_id:1, nombre:"Huarache Sencillo", precio:35, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:2, categoria_id:1, nombre:"Huarache con Quesillo", precio:70, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:3, categoria_id:1, nombre:"Huarache con Huevo", precio:45, quesillo_extra_precio:40, disponible:true, orden:0},
            {id:4, categoria_id:1, nombre:"Huarache con Chicharron", precio:75, quesillo_extra_precio:20, disponible:false, orden:0},
            {id:5, categoria_id:1, nombre:"Huarache con Tinga de Pollo", precio:75, quesillo_extra_precio:20, disponible:true, orden:0},
            {id:6, categoria_id:1, nombre:"Huarache con Tinga de Res", precio:80, quesillo_extra_precio:20, disponible:false, orden:0},
            {id:7, categoria_id:1, nombre:"Huarache con Bistec", precio:75, quesillo_extra_precio:20, disponible:false, orden:0},
            {id:8, categoria_id:1, nombre:"Huarache con Suadero", precio:75, quesillo_extra_precio:20, disponible:false, orden:0},
            {id:9, categoria_id:1, nombre:"Huarache con Pastor", precio:75, quesillo_extra_precio:20, disponible:false, orden:0},
            {id:10, categoria_id:1, nombre:"Huarache con Cochinita", precio:80, quesillo_extra_precio:20, disponible:true, orden:0},
            {id:81, categoria_id:1, nombre:"Huarache con Longaniza", precio:75, quesillo_extra_precio:20, disponible:true, orden:10},
            {id:11, categoria_id:2, nombre:"Sope Sencillo", precio:35, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:12, categoria_id:2, nombre:"Sope con Quesillo", precio:60, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:13, categoria_id:2, nombre:"Sope con Huevo", precio:45, quesillo_extra_precio:10, disponible:true, orden:0},
            {id:14, categoria_id:2, nombre:"Sope con Chicharron", precio:65, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:15, categoria_id:2, nombre:"Sope con Tinga de Pollo", precio:65, quesillo_extra_precio:10, disponible:true, orden:0},
            {id:16, categoria_id:2, nombre:"Sope con Tinga de Res", precio:70, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:17, categoria_id:2, nombre:"Sope con Bistec", precio:65, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:18, categoria_id:2, nombre:"Sope con Suadero", precio:65, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:19, categoria_id:2, nombre:"Sope con Longaniza", precio:65, quesillo_extra_precio:10, disponible:true, orden:0},
            {id:20, categoria_id:2, nombre:"Sope con Pastor", precio:65, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:21, categoria_id:2, nombre:"Sope con Cochinita", precio:70, quesillo_extra_precio:10, disponible:true, orden:0},
            {id:82, categoria_id:2, nombre:"Sope Campechano", precio:65, quesillo_extra_precio:10, disponible:true, orden:20},
            {id:22, categoria_id:3, nombre:"Taco de Suadero", precio:30, quesillo_extra_precio:5, disponible:false, orden:0},
            {id:23, categoria_id:3, nombre:"Taco de Pastor", precio:30, quesillo_extra_precio:5, disponible:false, orden:0},
            {id:24, categoria_id:3, nombre:"Taco de Bistec", precio:30, quesillo_extra_precio:5, disponible:false, orden:0},
            {id:25, categoria_id:3, nombre:"Taco de Longaniza", precio:30, quesillo_extra_precio:5, disponible:true, orden:0},
            {id:26, categoria_id:3, nombre:"Taco Campechano", precio:30, quesillo_extra_precio:5, disponible:false, orden:0},
            {id:27, categoria_id:4, nombre:"Gordita Sencilla", precio:35, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:28, categoria_id:4, nombre:"Gordita con Quesillo", precio:45, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:29, categoria_id:4, nombre:"Gordita con Tinga de Pollo", precio:65, quesillo_extra_precio:10, disponible:true, orden:0},
            {id:30, categoria_id:4, nombre:"Gordita con Tinga de Res", precio:70, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:31, categoria_id:4, nombre:"Gordita con Bistec", precio:65, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:32, categoria_id:4, nombre:"Gordita con Suadero", precio:65, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:33, categoria_id:4, nombre:"Gordita con Pastor", precio:65, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:34, categoria_id:4, nombre:"Gordita Campechana", precio:65, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:35, categoria_id:4, nombre:"Gordita con Longaniza", precio:65, quesillo_extra_precio:10, disponible:true, orden:0},
            {id:36, categoria_id:4, nombre:"Gordita con Cochinita", precio:70, quesillo_extra_precio:10, disponible:true, orden:0},
            {id:37, categoria_id:5, nombre:"Quesadilla de Quesillo", precio:25, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:38, categoria_id:5, nombre:"Quesadilla de Chicharron", precio:25, quesillo_extra_precio:5, disponible:false, orden:0},
            {id:39, categoria_id:5, nombre:"Quesadilla de Hongos", precio:25, quesillo_extra_precio:5, disponible:true, orden:0},
            {id:40, categoria_id:5, nombre:"Quesadilla de Papa con Longaniza", precio:25, quesillo_extra_precio:5, disponible:true, orden:0},
            {id:41, categoria_id:5, nombre:"Quesadilla de Tinga de Pollo", precio:25, quesillo_extra_precio:5, disponible:true, orden:0},
            {id:42, categoria_id:5, nombre:"Quesadilla de Tinga de Res", precio:27, quesillo_extra_precio:5, disponible:false, orden:0},
            {id:43, categoria_id:5, nombre:"Quesadilla de Cochinita", precio:30, quesillo_extra_precio:5, disponible:true, orden:0},
            {id:44, categoria_id:6, nombre:"Pambazo de Chicharron", precio:30, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:45, categoria_id:6, nombre:"Pambazo de Papa con Longaniza", precio:30, quesillo_extra_precio:10, disponible:true, orden:0},
            {id:46, categoria_id:6, nombre:"Pambazo de Tinga de Pollo", precio:30, quesillo_extra_precio:10, disponible:true, orden:0},
            {id:47, categoria_id:6, nombre:"Pambazo de Tinga de Res", precio:35, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:48, categoria_id:6, nombre:"Pambazo de Bistec", precio:40, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:49, categoria_id:6, nombre:"Pambazo de Suadero", precio:40, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:50, categoria_id:6, nombre:"Pambazo de Pastor", precio:40, quesillo_extra_precio:10, disponible:false, orden:0},
            {id:51, categoria_id:6, nombre:"Pambazo de Cochinita", precio:40, quesillo_extra_precio:10, disponible:true, orden:0},
            {id:52, categoria_id:7, nombre:"Torta de Bistec", precio:70, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:53, categoria_id:7, nombre:"Torta de Suadero", precio:70, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:54, categoria_id:7, nombre:"Torta de Pastor", precio:70, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:55, categoria_id:7, nombre:"Torta de Cochinita", precio:75, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:56, categoria_id:7, nombre:"Torta Campechana", precio:70, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:83, categoria_id:7, nombre:"Torta de Longaniza", precio:70, quesillo_extra_precio:0, disponible:true, orden:30},
            {id:57, categoria_id:8, nombre:"Tostada de Pata", precio:30, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:58, categoria_id:8, nombre:"Tostada de Tinga de Pollo", precio:30, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:59, categoria_id:8, nombre:"Tostada de Tinga de Res", precio:35, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:60, categoria_id:8, nombre:"Tostada de Cochinita", precio:35, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:61, categoria_id:9, nombre:"Burrito de Bistec", precio:75, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:62, categoria_id:9, nombre:"Burrito de Suadero", precio:75, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:63, categoria_id:9, nombre:"Burrito de Pastor", precio:75, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:64, categoria_id:9, nombre:"Burrito de Cochinita", precio:80, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:65, categoria_id:9, nombre:"Burrito Campechano", precio:75, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:66, categoria_id:9, nombre:"Burrito Longaniza", precio:75, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:67, categoria_id:9, nombre:"Costra de Bistec", precio:40, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:68, categoria_id:9, nombre:"Costra de Suadero", precio:40, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:69, categoria_id:9, nombre:"Costra de Pastor", precio:40, quesillo_extra_precio:0, disponible:false, orden:0},
            {id:70, categoria_id:9, nombre:"Costra de Longaniza", precio:40, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:71, categoria_id:9, nombre:"Costra de Cochinita", precio:40, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:72, categoria_id:10, nombre:"Ponche 1L", precio:35, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:73, categoria_id:10, nombre:"Ponche 1/2L", precio:20, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:74, categoria_id:10, nombre:"Agua de Jamaica 1L", precio:25, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:75, categoria_id:10, nombre:"Agua de Jamaica 1/2L", precio:15, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:76, categoria_id:10, nombre:"Agua de Horchata 1L", precio:30, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:77, categoria_id:10, nombre:"Agua de Horchata 1/2L", precio:17, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:78, categoria_id:10, nombre:"Coca Cola 600ml", precio:26, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:79, categoria_id:10, nombre:"Coca Cola 3L", precio:50, quesillo_extra_precio:0, disponible:true, orden:0},
            {id:80, categoria_id:10, nombre:"Coca Cola 1.75L", precio:42, quesillo_extra_precio:0, disponible:true, orden:0}
        ];

        const calculateDistance = (lat1, lon1, lat2, lon2) => { const R = 6371; const dLat = (lat2 - lat1) * Math.PI / 180; const dLon = (lon2 - lon1) * Math.PI / 180; const a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) * Math.sin(dLon/2) * Math.sin(dLon/2); const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); return R * c; };
        const getAvailableToppings = (category, itemName) => { const cat = category || ""; const item = itemName || ""; if (cat === 'Bebidas') return []; if (cat === 'Huaraches' || cat === 'Gorditas') return ['Cebolla', 'Queso Rallado']; if (cat === 'Sopes') return ['Cebolla', 'Queso Rallado', 'Lechuga']; if (cat === 'Tostadas' || cat === 'Pambazos') return ['Queso Rallado', 'Crema', 'Lechuga']; if (cat === 'Tortas') return ['Cebolla', 'Cilantro']; if (cat === 'Tacos') return ['Cebolla', 'Cilantro', 'Nopales']; if (cat === 'Quesadillas') return ['Lechuga', 'Queso']; if (cat === 'Burritos y Costras') { if (item.includes('Costra')) return ['Cebolla', 'Cilantro', 'Nopales']; return ['Nopales', 'Pepinos']; } return []; };
        const Icon = memo(({ d, size = 28, className = "" }) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d={d} /></svg>));
        const Icons = { Cart: (p) => <svg {...p} width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>, Map: (p) => <svg {...p} width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>, Check: (p) => <Icon {...p} d="M20 6L9 17l-5-5" />, Plus: (p) => <Icon {...p} d="M12 5v14M5 12h14" />, Minus: (p) => <Icon {...p} d="M5 12h14" />, Send: (p) => <svg {...p} width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>, Info: (p) => <svg {...p} width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>, Cash: (p) => <svg {...p} width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="2" y="7" width="20" height="14" rx="2" ry="2"></rect><line x1="12" y1="7" x2="12" y2="21"></line><path d="M16.5 13.5h.01"></path><path d="M7.5 13.5h.01"></path></svg>, Phone: (p) => <svg {...p} width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"></rect><line x1="12" y1="18" x2="12.01" y2="18"></line></svg>, Card: (p) => <svg {...p} width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect><line x1="1" y1="10" x2="23" y2="10"></line></svg>, Search: (p) => <svg {...p} width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>, Clock: (p) => <svg {...p} width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> };
        const Button = memo(({ onClick, children, variant = "primary", className = "", disabled = false, icon: IconComp }) => { const variants = { primary: "bg-gradient-to-r from-orange-500 to-red-600 text-white shadow-lg shadow-orange-500/40 active:scale-95 hover:brightness-110 disabled:opacity-50 disabled:pointer-events-none", secondary: "bg-gray-800 text-white hover:bg-gray-700", danger: "bg-red-100 text-red-800 border border-red-200" }; return ( <button type="button" onClick={onClick} disabled={disabled} className={`px-6 py-4 rounded-xl font-bold flex items-center justify-center gap-3 transition-all text-lg ${variants[variant]} ${className}`}> {IconComp && <IconComp size={28} />} {children} </button> ); });

        const ProductItem = memo(({ item, category, onAdd }) => {
            const [withQuesillo, setWithQuesillo] = useState(false);
            const [conTodo, setConTodo] = useState(true);
            const [exclusions, setExclusions] = useState({});
            const isAvailable = item.disponible;
            const quesilloExtraPrecio = parseFloat(item.quesillo_extra_precio || 0);
            const hasExtra = quesilloExtraPrecio > 0 && isAvailable;
            const currentPrice = hasExtra && withQuesillo ? parseFloat(item.precio) + quesilloExtraPrecio : parseFloat(item.precio);
            const availableToppings = useMemo(() => getAvailableToppings(category, item.nombre), [category, item.nombre]);
            useEffect(() => { setConTodo(true); setExclusions({}); }, [item.nombre]);
            const toggleConTodo = useCallback(() => { if (!conTodo) { setConTodo(true); setExclusions({}); } }, [conTodo]);
            const toggleExclusion = useCallback((topping) => { setExclusions(prev => { const newState = !prev[topping]; const newExclusions = { ...prev, [topping]: newState }; const anyExcluded = Object.values(newExclusions).some(val => val === true); setConTodo(!anyExcluded); return newExclusions; }); }, []);
            const handleAdd = useCallback(() => { let details = ""; const activeExclusions = Object.entries(exclusions).filter(([_, isExcluded]) => isExcluded).map(([name]) => name); if (availableToppings.length === 0) details = ""; else if (conTodo) details = " (Con Todo)"; else if (activeExclusions.length === availableToppings.length) details = " (SIN NADA / SOLO)"; else if (activeExclusions.length > 0) details = ` (SIN ${activeExclusions.join(', SIN ')})`; else details = " (Con Todo)"; onAdd({ ...item, name: item.nombre, price: currentPrice, isExtra: withQuesillo, details: details }); }, [exclusions, conTodo, availableToppings, onAdd, item, currentPrice, withQuesillo]);

            return (
                <div className={`bg-white rounded-2xl shadow-sm border border-gray-200 p-5 flex flex-col animate-slide-up h-full ${!isAvailable ? 'opacity-60 bg-gray-100' : ''}`}>
                    <div className="p-2 flex-grow">
                        <div className="flex justify-between items-start mb-4">
                            <h3 className="font-bold text-gray-900 text-xl leading-tight">{item.nombre}</h3>
                            <div className="flex flex-col items-end">
                                <span className="bg-orange-100 text-orange-800 px-3 py-1 rounded-lg font-bold text-lg whitespace-nowrap ml-2">${currentPrice.toFixed(2)}</span>
                                {!isAvailable && <span className="text-xs bg-red-600 text-white px-2 py-1 rounded mt-1 font-bold">AGOTADO</span>}
                            </div>
                        </div>
                        {isAvailable && availableToppings.length > 0 && (
                            <div className="mb-4 flex flex-col gap-2">
                                <p className='text-sm text-gray-500 mb-1 font-semibold'>Personaliza tu orden:</p>
                                <label className="flex items-center gap-3 text-base font-bold text-gray-900 cursor-pointer select-none p-2 rounded bg-orange-50 border border-orange-200 hover:bg-orange-100 transition-colors"><input type="checkbox" checked={conTodo} onChange={toggleConTodo} className="w-5 h-5 rounded accent-orange-600" />Con Todo</label>
                                <div className="grid grid-cols-2 gap-2 mt-1">{availableToppings.map(t => ( <label key={t} className={`flex items-center gap-2 text-sm cursor-pointer select-none p-2 rounded border transition-colors ${exclusions[t] ? 'bg-red-50 border-red-200 text-red-700' : 'bg-gray-50 border-gray-200 text-gray-600 hover:bg-gray-100'}`}><input type="checkbox" checked={exclusions[t] || false} onChange={() => toggleExclusion(t)} className="w-4 h-4 rounded accent-red-600" />Sin {t}</label> ))}</div>
                            </div>
                        )}
                        {hasExtra && ( <div onClick={() => setWithQuesillo(!withQuesillo)} role="button" tabIndex="0" className={`flex items-center gap-3 p-3 rounded-xl border cursor-pointer mb-4 transition-all ${withQuesillo ? 'border-orange-500 bg-orange-50 ring-1 ring-orange-500' : 'border-gray-200 bg-gray-50 hover:bg-gray-100'}`}><div className={`w-6 h-6 rounded border flex items-center justify-center ${withQuesillo ? 'bg-orange-500 border-orange-500' : 'bg-white border-gray-400'}`}>{withQuesillo && <Icons.Check size={16} className="text-white" />}</div><span className="text-base font-medium text-gray-800">Quesillo Extra (+${quesilloExtraPrecio})</span></div> )}
                    </div>
                    <div className="p-4 pt-0 mt-auto"><Button onClick={handleAdd} disabled={!isAvailable} className="w-full text-lg py-3 hover:brightness-110 active:scale-95" icon={Icons.Plus}>{isAvailable ? 'Agregar' : 'No disponible'}</Button></div>
                </div>
            );
        });

        const App = () => {
            const [categoriesDB, setCategoriesDB] = useState([]);
            const [menuItemsDB, setMenuItemsDB] = useState([]);
            const [isLoading, setIsLoading] = useState(true);
            const [cart, setCart] = useState([]);
            const [activeCategory, setActiveCategory] = useState("");
            const [showCart, setShowCart] = useState(false);
            const [notification, setNotification] = useState(null);
            const [location, setLocation] = useState({ lat: null, lng: null, status: 'idle', distance: null, allowed: false });
            const [customer, setCustomer] = useState({ name: '', phone: '', salsa: '', paymentMethod: '', paymentAmount: '', instructions: '', tip: '' });
            const [searchTerm, setSearchTerm] = useState("");
            const [showWaitModal, setShowWaitModal] = useState(false);
            const [isOpen, setIsOpen] = useState(true);

            // --- 1. L√ìGICA DE HORARIO (ACTIVA) ---
            const checkSchedule = () => {
                const now = new Date();
                const day = now.getDay(); // 0=Dom, 1=Lun, 2=Mar, 3=Mie, 4=Jue, 5=Vie, 6=Sab
                
                // Si es Martes (2) -> CERRADO
                if (day === 2) return false;

                const hour = now.getHours();
                const minute = now.getMinutes();
                const timeInMinutes = hour * 60 + minute;

                const start = 18 * 60 + 20; // 6:20 PM -> 1100 min
                const end = 22 * 60 + 20;   // 10:20 PM -> 1340 min (Instrucci√≥n 1)

                // Si est√° dentro del rango -> ABIERTO
                if (timeInMinutes >= start && timeInMinutes <= end) {
                    return true;
                }
                return false;
            };

            useEffect(() => {
                setIsOpen(checkSchedule());
                const interval = setInterval(() => setIsOpen(checkSchedule()), 60000);
                return () => clearInterval(interval);
            }, []);

            useEffect(() => {
                const fetchData = async () => {
                    if (!supabase) { setCategoriesDB(STATIC_CATEGORIES); setMenuItemsDB(STATIC_PRODUCTS); if (STATIC_CATEGORIES.length > 0) setActiveCategory(STATIC_CATEGORIES[0].nombre); setIsLoading(false); return; }
                    try {
                        const { data: cats, error: errCats } = await supabase.from('categorias').select('*').order('orden', { ascending: true });
                        if (errCats) throw errCats;
                        const { data: items, error: errItems } = await supabase.from('menu_items').select('*');
                        if (errItems) throw errItems;
                        setCategoriesDB(cats); setMenuItemsDB(items);
                        if (cats.length > 0) setActiveCategory(cats[0].nombre);
                    } catch (error) { console.error("Error cargando men√∫:", error); setCategoriesDB(STATIC_CATEGORIES); setMenuItemsDB(STATIC_PRODUCTS); } finally { setIsLoading(false); }
                };
                fetchData();
                if (supabase) { const channel = supabase.channel('public:menu_items').on('postgres_changes', { event: '*', schema: 'public', table: 'menu_items' }, () => fetchData()).subscribe(); return () => { supabase.removeChannel(channel); }; }
            }, []);

            useEffect(() => { const saved = localStorage.getItem('huarachesDeliveryCart'); if (saved) try { setCart(JSON.parse(saved)); } catch (e) {} }, []);
            useEffect(() => { localStorage.setItem('huarachesDeliveryCart', JSON.stringify(cart)); }, [cart]);

            const processedMenu = useMemo(() => {
                if (!categoriesDB.length) return [];
                return categoriesDB.map(cat => {
                    let catItems = menuItemsDB.filter(item => 
                        item.categoria_id === cat.id && 
                        item.nombre.toLowerCase().includes(searchTerm.toLowerCase())
                    );
                    catItems.sort((a, b) => {
                        const nameA = a.nombre.toLowerCase(); const nameB = b.nombre.toLowerCase();
                        if (cat.nombre === 'Burritos y Costras') {
                            const getWeight = (n) => { if (n.includes('burrito')) return 1; if (n.includes('costra')) return 2; return 3; };
                            return getWeight(nameA) - getWeight(nameB) || a.orden - b.orden;
                        }
                        const getWeight = (n) => { if (n.includes('sencillo')) return 1; if (n.includes('quesillo')) return 2; if (n.includes('huevo')) return 3; return 10; };
                        if (cat.nombre === 'Bebidas') { const getDrinkWeight = (n) => { if (n.includes('jamaica')) return 1; if (n.includes('horchata')) return 2; if (n.includes('ponche')) return 3; return 10; }; return getDrinkWeight(nameA) - getDrinkWeight(nameB) || a.orden - b.orden; }
                        const weightA = getWeight(nameA); const weightB = getWeight(nameB); if (weightA !== weightB) return weightA - weightB; return a.orden - b.orden;
                    });
                    return { id: cat.id, category: cat.nombre, prepNote: cat.nota_preparacion, items: catItems };
                }).filter(cat => cat.items.length > 0);
            }, [categoriesDB, menuItemsDB, searchTerm]);

            const showNotification = useCallback((msg) => { setNotification(msg); setTimeout(() => setNotification(null), 3000); }, []);
            const addToCart = useCallback((product) => { const key = `${product.nombre}-${product.price}-${product.details}-${product.isExtra}`; setCart(prev => { const existingIndex = prev.findIndex(p => p.key === key); if (existingIndex > -1) { const newCart = [...prev]; newCart[existingIndex].qty += 1; return newCart; } return [...prev, { ...product, qty: 1, key }]; }); showNotification(`¬°${product.nombre}${product.isExtra ? " (con Quesillo)" : ""} agregado!`); }, [showNotification]);
            const updateQty = useCallback((key, delta) => { setCart(prev => prev.map(p => p.key === key ? { ...p, qty: Math.max(0, p.qty + delta) } : p).filter(p => p.qty > 0)); }, []);

            // --- 2. L√ìGICA DE DISTANCIA (SIN DISTANCIAS VISIBLES EN UI) ---
            const getLocation = () => {
                if (!navigator.geolocation) return setLocation(prev => ({ ...prev, status: 'error' }));
                if(!confirm(`üìç Huaraches La 18 necesita tu ubicaci√≥n para verificar que est√°s dentro de la zona de reparto (${CONFIG.maxDeliveryRadius} km).\n\n¬øPermitir acceso al GPS?`)) return;
                setLocation(prev => ({ ...prev, status: 'loading' }));
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        const userLat = pos.coords.latitude; const userLng = pos.coords.longitude;
                        const distKm = calculateDistance(CONFIG.storeLocation.lat, CONFIG.storeLocation.lng, userLat, userLng);
                        const isAllowed = distKm <= CONFIG.maxDeliveryRadius;
                        setLocation({ lat: userLat, lng: userLng, status: 'success', distance: distKm.toFixed(2), allowed: isAllowed });
                        
                        // Instrucci√≥n 2: Solo mencionar distancia al validar
                        if(isAllowed) { 
                            showNotification(`‚úÖ Ubicaci√≥n verificada dentro de zona. ¬°Gracias!`); 
                        } else { 
                            alert(`‚ö†Ô∏è EST√ÅS FUERA DE ZONA\n\nEst√°s a ${distKm.toFixed(2)}km y nuestro l√≠mite es de ${CONFIG.maxDeliveryRadius}km.\n\nLo sentimos, por ahora no tenemos cobertura en esa √°rea.`); 
                        }
                    },
                    (err) => { console.error(err); setLocation(prev => ({ ...prev, status: 'error' })); showNotification("Error: Activa tu GPS e intenta de nuevo."); },
                    { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
                );
            };

            const totals = useMemo(() => { const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0); const tip = parseFloat(customer.tip) || 0; let baseTotal = subtotal + CONFIG.shippingCost + tip; const cardFee = customer.paymentMethod === 'tarjeta' ? baseTotal * CONFIG.cardFeePercent : 0; return { subtotal, tip, cardFee, finalTotal: baseTotal + cardFee }; }, [cart, customer.tip, customer.paymentMethod]);

            const handleCheckout = async () => {
                if (totals.subtotal < 100) return showNotification(`‚ö†Ô∏è El pedido m√≠nimo es de $100`);
                if (!customer.name || !customer.phone || !customer.salsa || !customer.paymentMethod || cart.length === 0) return showNotification("‚ö†Ô∏è Faltan datos obligatorios");
                if (location.status !== 'success') return showNotification("‚ö†Ô∏è Por favor valida tu ubicaci√≥n antes de pedir");
                
                // --- 4. FILTRO DE DISTANCIA COMENTADO (PARA PRUEBAS) ---
                // Para activar, borra las dos barras // del inicio de la siguiente l√≠nea:
                // if (!location.allowed) return alert(`üö´ No podemos procesar el pedido. Est√°s fuera del rango de reparto.`);
                // ----------------------------------------------------------

                setShowWaitModal(true);
            };

            // --- 3. CONFIRMACI√ìN Y ENV√çO ---
            const confirmAndSend = () => {
                setShowWaitModal(false);
                showNotification("‚è≥ Procesando pedido...");
                
                let msg = `üî• *PEDIDO A DOMICILIO* üî•\n\nüë§ *Cliente:* ${customer.name}\nüì± *Tel:* ${customer.phone}\nüå∂Ô∏è *Salsa:* ${customer.salsa}\n--------------------------------\n`;
                cart.forEach(item => { msg += `‚úÖ *${item.qty}* *x* *${item.nombre}* ${item.isExtra ? '(c/Quesillo)' : ''} ${item.details || ''}- $${(item.price * item.qty).toFixed(2)}\n`; });
                if (customer.instructions) msg += `\nüìù *Notas:* ${customer.instructions}`;
                msg += `\n--------------------------------\nSubtotal: $${totals.subtotal.toFixed(2)}\nüõµ Env√≠o: $${CONFIG.shippingCost.toFixed(2)}\n`;
                if (totals.tip > 0) msg += `üí∏ Propina: *$${totals.tip.toFixed(2)}*\n`;
                if (totals.cardFee > 0) msg += `üí≥ Comisi√≥n: $${totals.cardFee.toFixed(2)}\n`;
                msg += `*üí∞ TOTAL: $${totals.finalTotal.toFixed(2)}*\n*Pago:* ${customer.paymentMethod.toUpperCase()} ${customer.paymentMethod === 'efectivo' ? '(Con: $'+customer.paymentAmount+')' : ''}`;
                msg += `\nüìç Ubicaci√≥n Confirmada: https://www.google.com/maps/search/?api=1&query=${location.lat},${location.lng}`;

                window.open(`https://wa.me/${CONFIG.phone}?text=${encodeURIComponent(msg)}`, '_blank');

                if (supabase) { supabase.from('pedidos').insert([{ cliente_nombre: customer.name, cliente_telefono: customer.phone, total: totals.finalTotal, metodo_pago: customer.paymentMethod, detalle_json: cart, }]).then(({ error }) => { if (error) console.error("Error guardando pedido:", error); }); }
                setCart([]); localStorage.removeItem('huarachesDeliveryCart'); setShowCart(false);
            };

            if (isLoading) return <div className="min-h-screen bg-gray-900 flex items-center justify-center"><div className="loader"></div></div>;

            return (
                <div className="relative min-h-screen bg-gradient-to-br from-yellow-400 via-orange-500 to-red-600 pb-24 text-base">
                    <div className="fixed inset-0 z-0 bg-orange-500 pointer-events-none"><div className="absolute inset-0 bg-cover bg-center opacity-20 mix-blend-overlay transition-opacity duration-700" style={{ backgroundImage: `url(${CONFIG.assets.background})` }} /></div>
                    <header className="bg-black/90 backdrop-blur-md shadow-2xl border-b-4 border-orange-600 rounded-b-3xl mx-auto max-w-2xl px-4 py-6 text-center z-50 relative">
                        <img src={CONFIG.assets.logo} alt="Logo" width="112" height="112" className="h-28 w-28 rounded-full logo-electric mb-2 mx-auto img-skeleton" loading="eager" />
                        <h1 className="text-3xl font-black text-metal-shine tracking-widest drop-shadow-sm">{CONFIG.storeName}</h1>
                        <p className="text-white text-sm opacity-80">Servicio a Domicilio</p>
                    </header>
                    <main className="max-w-4xl mx-auto p-4 relative z-10">
                        <div className="sticky top-0 z-40 -mx-4 pt-4 bg-gradient-to-b from-black/60 to-transparent backdrop-blur-sm mb-4 pb-2">
                            <div className="px-4 pb-4 max-w-lg mx-auto"><div className="relative group"><div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"><Icons.Search className="text-gray-400 group-focus-within:text-orange-500 transition-colors" /></div><input type="text" placeholder="Busca tu producto (ej. Huarache, Sope...)" value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className="w-full bg-gray-900/80 text-white pl-10 pr-4 py-3 rounded-2xl border border-gray-600 focus:border-orange-500 focus:ring-2 focus:ring-orange-500/50 outline-none transition-all placeholder-gray-500 shadow-lg" />{searchTerm && (<button onClick={() => setSearchTerm('')} className="absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-white">‚úï</button>)}</div></div>
                            {!searchTerm && ( <div className="flex gap-2 flex-wrap justify-center pb-2 px-4">{processedMenu.map(cat => ( <button key={cat.id} onClick={() => setActiveCategory(cat.category)} className={`whitespace-nowrap px-4 py-2 rounded-full font-bold text-base transition-all transform active:scale-95 ${activeCategory === cat.category ? 'bg-white text-orange-600 scale-105 shadow-lg' : 'bg-black/50 text-white border border-white/20'}`}>{cat.category}</button> ))}</div> )}
                        </div>

                        {processedMenu.map(cat => (searchTerm || cat.category === activeCategory) && (
                            <div key={cat.id} className="animate-slide-up min-h-[20vh] mb-8">
                                {searchTerm && <h2 className="text-white font-bold text-xl mb-4 pl-2 border-l-4 border-orange-500">{cat.category}</h2>}
                                {cat.prepNote && !searchTerm && (<div className="bg-white/90 backdrop-blur-sm border-l-4 border-orange-500 p-4 rounded-r-lg mb-6 flex items-center gap-3 text-base shadow-sm"><Icons.Info className="text-orange-500 flex-shrink-0" size={24} /><p className="italic text-gray-800 font-medium">{cat.prepNote}</p></div>)}
                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">{cat.items.map((item) => (<ProductItem key={item.id} item={item} category={cat.category} onAdd={addToCart} />))}</div>
                            </div>
                        ))}
                        
                        {processedMenu.length === 0 && searchTerm && (<div className="text-center text-white py-10 opacity-80"><p className="text-xl font-bold">No encontramos ese antojo üò¢</p><p className="text-sm">Intenta buscar otra cosa.</p></div>)}

                        <div id="cart" className={`transition-all duration-500 transform ${cart.length > 0 ? 'opacity-100 translate-y-0' : 'opacity-0 translate-y-20 h-0 overflow-hidden'}`}>
                            {cart.length > 0 && (
                                <div className="mt-10 bg-white rounded-3xl shadow-2xl overflow-hidden border-t-4 border-orange-500">
                                    <div className="bg-gray-900 p-6 flex items-center gap-3 text-white"><Icons.Cart className="text-orange-500" size={32} /><h2 className="font-bold text-2xl">Tu Pedido</h2></div>
                                    <div className="p-6 max-h-[500px] overflow-y-auto custom-scrollbar space-y-4">
                                        {cart.map(item => ( <div key={item.key} className="flex justify-between items-center bg-gray-50 p-4 rounded-xl border border-gray-200 shadow-sm"><div className="flex items-center gap-4"><span className="bg-orange-100 text-orange-800 font-bold w-10 h-10 flex items-center justify-center rounded-lg text-lg">{item.qty}</span><div><p className="font-bold text-gray-900 text-lg leading-tight">{item.nombre}</p><p className="text-sm text-gray-600 mt-1">{item.details}</p><p className="text-base text-gray-800 font-bold mt-1">${item.price} {item.isExtra && '(c/Quesillo)'}</p></div></div><div className="flex gap-3"><button onClick={() => updateQty(item.key, -1)} className="p-3 bg-white border rounded-lg text-gray-500 hover:text-red-500 active:bg-gray-100"><Icons.Minus size={20} /></button><button onClick={() => updateQty(item.key, 1)} className="p-3 bg-orange-500 text-white rounded-lg shadow-md active:bg-orange-600"><Icons.Plus size={20} /></button></div></div> ))}
                                    </div>
                                    <div className="bg-gray-50 p-6 border-t space-y-6">
                                        <h3 className="font-bold text-gray-600 text-base uppercase flex items-center gap-2"><Icons.Map size={24} /> Datos de Entrega</h3>
                                        <input type="text" placeholder="Nombre Completo" value={customer.name} onChange={e=>setCustomer({...customer, name:e.target.value})} className="w-full p-4 bg-white border rounded-xl text-lg shadow-sm" />
                                        <input type="tel" placeholder="N√∫mero de Tel√©fono" value={customer.phone} onChange={e=>setCustomer({...customer, phone:e.target.value})} className="w-full p-4 bg-white border rounded-xl text-lg shadow-sm" />
                                        <select value={customer.salsa} onChange={e=>setCustomer({...customer, salsa:e.target.value})} className="w-full p-4 bg-white border rounded-xl text-lg shadow-sm"><option value="">üå∂Ô∏è Elige tu Salsa...</option><option value="Verde">Verde</option><option value="Roja">Roja</option><option value="Ambas">Ambas</option><option value="Sin Salsa">Sin Salsa</option></select>
                                        <textarea className="w-full p-4 bg-white border border-gray-300 rounded-xl text-lg shadow-sm" placeholder="Instrucciones..." rows="2" value={customer.instructions} onChange={e => setCustomer({...customer, instructions: e.target.value})} />
                                        
                                        {/* 2. BOT√ìN DE UBICACI√ìN (SIN DISTANCIA visible) */}
                                        <div className="space-y-2">
                                            <Button onClick={getLocation} variant={location.status === 'success' ? (location.allowed ? 'primary' : 'danger') : 'secondary'} className={`w-full text-base py-4 ${location.status === 'success' && location.allowed ? 'bg-green-600' : ''}`} icon={Icons.Map}>
                                                {location.status === 'loading' ? 'üìç Buscando...' : 
                                                 location.status === 'success' ? 
                                                    (location.allowed ? `‚úÖ Ubicaci√≥n Verificada` : `üö´ Fuera de Zona`) 
                                                 : 'üìç Validar Ubicaci√≥n de Entrega'}
                                            </Button>
                                        </div>

                                        <div className="grid grid-cols-3 gap-4">{['efectivo', 'transferencia', 'tarjeta'].map(m => ( <button key={m} onClick={() => setCustomer({...customer, paymentMethod: m})} className={`py-4 rounded-xl text-sm font-bold uppercase border flex flex-col items-center gap-2 ${customer.paymentMethod === m ? 'bg-gray-800 text-white' : 'bg-white text-gray-600'}`}>{m === 'efectivo' && <Icons.Cash size={28} />} {m === 'transferencia' && <Icons.Phone size={28} />} {m === 'tarjeta' && <Icons.Card size={28} />} {m}</button> ))}</div>
                                        {customer.paymentMethod === 'efectivo' && <input type="number" placeholder="¬øCon cu√°nto pagas?" value={customer.paymentAmount} onChange={e=>setCustomer({...customer, paymentAmount:e.target.value})} className="w-full p-4 border-2 border-green-500 bg-green-50 rounded-xl text-lg font-bold" />}
                                        {customer.paymentMethod === 'transferencia' && <div className="p-5 bg-blue-50 border border-blue-200 rounded-xl text-blue-900"><p className="font-bold mb-2">NU BANK</p><p className="font-mono select-all">638180000198739591</p><p>ERICK MALDONADO</p></div>}
                                        <div className="bg-orange-100/50 p-6 rounded-xl space-y-3 border border-orange-200"><div className="flex justify-between"><span>Subtotal</span><span>${totals.subtotal.toFixed(2)}</span></div><div className="flex justify-between"><span>Env√≠o</span><span>${CONFIG.shippingCost.toFixed(2)}</span></div><div className="flex justify-between items-center"><span>Propina</span><input type="number" placeholder="0" value={customer.tip} onChange={e => setCustomer({...customer, tip: e.target.value})} className="w-24 p-1 border rounded text-right" /></div>{totals.cardFee > 0 && <div className="flex justify-between font-bold text-purple-700"><span>Comisi√≥n</span><span>${totals.cardFee.toFixed(2)}</span></div>}<div className="flex justify-between font-black text-3xl pt-2 border-t border-orange-200"><span>TOTAL</span><span>${totals.finalTotal.toFixed(2)}</span></div></div>
                                        
                                        {/* 1. BOT√ìN DE ENV√çO CON CONTROL DE HORARIO */}
                                        <Button onClick={handleCheckout} disabled={!isOpen || (location.status !== 'success')} className={`w-full py-5 text-xl shadow-xl ${isOpen ? (location.status === 'success' ? 'animate-pulse-glow' : 'opacity-50') : 'bg-gray-400 opacity-60 cursor-not-allowed'}`} icon={isOpen ? Icons.Send : Icons.Clock}>
                                            {isOpen ? 'ENVIAR PEDIDO' : 'CERRADO (Abre 6:20 PM)'}
                                        </Button>
                                    </div>
                                </div>
                            )}
                        </div>
                    </main>
                    {!showCart && ( <button onClick={() => { setShowCart(true); setTimeout(()=>document.getElementById('cart')?.scrollIntoView({behavior:'smooth'}),100); }} className="fixed bottom-6 right-6 bg-orange-600 text-white p-4 rounded-full shadow-2xl z-50 hover:scale-110 transition-transform border-4 border-white active:scale-95"><Icons.Cart size={32}/><span className="absolute -top-2 -right-2 bg-red-600 text-xs font-bold w-7 h-7 rounded-full flex items-center justify-center border-2 border-white">{cart.reduce((a,c)=>a+c.qty,0)}</span></button> )}
                    {notification && <div className="fixed top-24 left-1/2 transform -translate-x-1/2 bg-gray-900/95 backdrop-blur text-white px-8 py-4 rounded-full shadow-2xl z-[100] flex items-center gap-3 text-lg font-bold animate-fade-in-down border border-gray-700"><div className="bg-green-500 rounded-full p-1"><Icons.Check size={20} className="text-white" /></div>{notification}</div>}
                    
                    {/* --- 5. MODAL DE TIEMPO DE ESPERA CON LOGO Y TEXTO ACTUALIZADO --- */}
                    {showWaitModal && (
                        <div className="fixed inset-0 z-[200] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in-down">
                            <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full p-6 text-center border-t-8 border-orange-500">
                                <div className="mx-auto mb-4">
                                    <img src={CONFIG.assets.logo} alt="Logo" className="w-24 h-24 rounded-full mx-auto shadow-md border-4 border-orange-100" />
                                </div>
                                <h3 className="text-2xl font-black text-gray-900 mb-2">¬°Casi listo!</h3>
                                <p className="text-gray-600 text-lg mb-6 leading-relaxed">
                                    Tu pedido ser√° enviado a cocina, la espera es de <strong className="text-orange-600">40-60 min aproximadamente</strong>.
                                    <br/><br/>
                                    <span className="text-sm italic font-semibold">Agradecemos tu paciencia y preferencia üôèüåÆ</span>
                                </p>
                                <div className="flex gap-3">
                                    <button onClick={() => setShowWaitModal(false)} className="flex-1 py-3 rounded-xl border border-gray-300 text-gray-600 font-bold hover:bg-gray-50">Cancelar</button>
                                    <button onClick={confirmAndSend} className="flex-1 py-3 rounded-xl bg-orange-600 text-white font-bold shadow-lg hover:bg-orange-700 active:scale-95 transition-transform">Aceptar y Enviar</button>
                                </div>
                            </div>
                        </div>
                    )}

                </div>
            );
        };
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>